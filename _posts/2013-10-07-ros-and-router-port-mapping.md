---
author: levin
comments: true
date: 2013-10-07 17:15:22+08:00
layout: post
title: "ROS和普通路由器的端口映射和转发"
categories:
- 未分类
---




网络环境：最外层是ROS，然后是普通的无线路由器，接着就是我自己的机子了。
现在需要给外网访问到我机子的80端口<!-- more -->，需要下面这些步骤：

#### 设置ROS

首先打开winbox，依次是ip->firewall->nat->添加一条记录：

* 常规(general)下面chain选择dstnat，protocol选择tcp，dst port填写外部访问的端口；
* 行为(action)下面action选择dst-nat，to address和to port填写需要映射的路由器的地址和端口。

添加完毕保存，外部端口我写的8000，路由器端口我写的80（路由器的管理后台访问端口之前改成了81，因此不存在端口冲突的问题）。

#### 设置路由器

接着是路由器，路由器的设置一般都大同小异，在转发规则下面的虚拟服务器添加一条规则：

这里的ip地址就是路由器接收到信息后要转发过去的地址，所以此处填上电脑的局域网ip地址。
普通的路由器转发功能比较弱，转发规则的端口同时指定了来路端口和目标端口，
由于上面ROS转发的目标端口设置为80，这里就只能填写80了，
此时转发的记录将会先发送到路由器的80端口，然后路由器再发到目标电脑上的80端口。

至此设置完毕。

